(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3520:()=>{},5399:()=>{},8059:(e,l,t)=>{"use strict";t.r(l),t.d(l,{default:()=>b});var n=t(5155),r=t(2115);function c(e){let{onSelectMode:l}=e,t=(0,r.useRef)(null);function c(e){t.current?(t.current.classList.add("fade-out"),setTimeout(()=>l(e),300)):l(e)}return(0,n.jsxs)("div",{className:"start-page fade-in",ref:t,children:[(0,n.jsx)("h1",{className:"start-title",children:"Welcome to Modern Chess"}),(0,n.jsxs)("div",{className:"start-buttons",children:[(0,n.jsx)("button",{className:"start-btn friend",onClick:()=>c("friend"),children:"Play a Friend Online"}),(0,n.jsx)("button",{className:"start-btn pass",onClick:()=>c("pass"),children:"Pass and Play"})]})]})}function o(e){return e.x>=0&&e.x<8&&e.y>=0&&e.y<8}function a(e,l,t){if(!o(l))return!1;let n=e[l.y][l.x];return!n||n.color!==t}function s(e,l,t){let n=[];for(let{dx:r,dy:c}of[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1}]){let a=e.x+r,s=e.y+c;for(;o({x:a,y:s});){let e=l[s][a];if(e){e.color!==t&&n.push({x:a,y:s});break}n.push({x:a,y:s}),a+=r,s+=c}}return n}function i(e,l,t){let n=[];for(let{dx:r,dy:c}of[{dx:1,dy:2},{dx:2,dy:1},{dx:-1,dy:2},{dx:-2,dy:1},{dx:1,dy:-2},{dx:2,dy:-1},{dx:-1,dy:-2},{dx:-2,dy:-1}]){let o={x:e.x+r,y:e.y+c};a(l,o,t)&&n.push(o)}return n}function u(e,l,t){let n=[];for(let{dx:r,dy:c}of[{dx:1,dy:1},{dx:1,dy:-1},{dx:-1,dy:1},{dx:-1,dy:-1}]){let a=e.x+r,s=e.y+c;for(;o({x:a,y:s});){let e=l[s][a];if(e){e.color!==t&&n.push({x:a,y:s});break}n.push({x:a,y:s}),a+=r,s+=c}}return n}function d(e,l,t){return[...s(e,l,t),...u(e,l,t)]}function p(e,l,t){let n=[];for(let{dx:r,dy:c}of[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1},{dx:1,dy:1},{dx:1,dy:-1},{dx:-1,dy:1},{dx:-1,dy:-1}]){let o={x:e.x+r,y:e.y+c};a(l,o,t)&&n.push(o)}return n}function h(e,l,t){for(let n=0;n<8;n++)for(let r=0;r<8;r++){let c=l[n][r];if(c&&c.color===t){let o=[];switch(c.type){case"pawn":let a="white"===t?-1:1;for(let l of[-1,1])if(r+l===e.x&&n+a===e.y)return!0;break;case"rook":o=s({x:r,y:n},l,t);break;case"knight":o=i({x:r,y:n},l,t);break;case"bishop":o=u({x:r,y:n},l,t);break;case"queen":o=d({x:r,y:n},l,t);break;case"king":o=p({x:r,y:n},l,t)}if(o.some(l=>l.x===e.x&&l.y===e.y))return!0}}return!1}t(9289),t(3520);let x={pawn:(e,l,t,n)=>n?function(e,l,t,n){let r=[],c="white"===t?-1:1,a="white"===t?6:1,s={x:e.x,y:e.y+c};if(o(s)&&!l[s.y][s.x]){r.push(s);let t={x:e.x,y:e.y+2*c};e.y!==a||l[t.y][t.x]||l[s.y][s.x]||r.push(t)}for(let a of[-1,1]){var i;let s={x:e.x+a,y:e.y+c};o(s)&&l[s.y][s.x]&&(null===(i=l[s.y][s.x])||void 0===i?void 0:i.color)!==t&&r.push(s),function(e,l,t,n){if(!t.enPassantTarget||t.enPassantTarget.x!==l.x||t.enPassantTarget.y!==l.y||e.y!==("white"===n?3:4)||1!==Math.abs(e.x-l.x)||l.y!==e.y+("white"===n?-1:1))return!1;let r=t.moveHistory[t.moveHistory.length-1];return!!r&&"pawn"===r.piece.type&&2===Math.abs(r.from.y-r.to.y)&&r.to.x===l.x&&r.to.y===e.y}(e,s,n,t)&&r.push(s)}return r}(e,l,t,n):function(e,l,t){let n=[],r="white"===t?-1:1,c={x:e.x,y:e.y+r};if(o(c)&&!l[c.y][c.x]){n.push(c);let o={x:e.x,y:e.y+2*r};e.y!==("white"===t?6:1)||l[o.y][o.x]||n.push(o)}for(let c of[-1,1]){var a;let s={x:e.x+c,y:e.y+r};o(s)&&l[s.y][s.x]&&(null===(a=l[s.y][s.x])||void 0===a?void 0:a.color)!==t&&n.push(s)}return n}(e,l,t),rook:s,knight:i,bishop:u,queen:d,king:(e,l,t,n)=>n?function(e,l,t,n){let r=[];for(let{dx:n,dy:c}of[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1},{dx:1,dy:1},{dx:1,dy:-1},{dx:-1,dy:1},{dx:-1,dy:-1}]){let o={x:e.x+n,y:e.y+c};a(l,o,t)&&r.push(o)}return("white"===t&&4===e.x&&7===e.y||"black"===t&&4===e.x&&0===e.y)&&(function(e,l){let t=7*("white"===e),n="".concat(4,",").concat(t),r="".concat(7,",").concat(t);if(l.hasMoved[n]||l.hasMoved[r])return!1;for(let e=5;e<7;e++)if(l.board[t][e])return!1;for(let n=4;n<=6;n++)if(h({x:n,y:t},l.board,"white"===e?"black":"white"))return!1;return!0}(t,n)&&r.push({x:6,y:e.y}),function(e,l){let t=7*("white"===e),n="".concat(4,",").concat(t),r="".concat(0,",").concat(t);if(l.hasMoved[n]||l.hasMoved[r])return!1;for(let e=1;e<4;e++)if(l.board[t][e])return!1;for(let n=2;n<=4;n++)if(h({x:n,y:t},l.board,"white"===e?"black":"white"))return!1;return!0}(t,n)&&r.push({x:2,y:e.y})),r}(e,l,t,n):p(e,l,t)},y={"♙":{type:"pawn",color:"white"},"♖":{type:"rook",color:"white"},"♘":{type:"knight",color:"white"},"♗":{type:"bishop",color:"white"},"♕":{type:"queen",color:"white"},"♔":{type:"king",color:"white"},"♟":{type:"pawn",color:"black"},"♜":{type:"rook",color:"black"},"♞":{type:"knight",color:"black"},"♝":{type:"bishop",color:"black"},"♛":{type:"queen",color:"black"},"♚":{type:"king",color:"black"}};function f(e){return e.map(e=>e.map(e=>e?{...y[e]}:null))}let m=e=>{let{isFlipped:l,boardEnabled:t,gameStarted:c,onMove:o}=e,[a,s]=(0,r.useState)([["♜","♞","♝","♛","♚","♝","♞","♜"],["♟","♟","♟","♟","♟","♟","♟","♟"],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],["♙","♙","♙","♙","♙","♙","♙","♙"],["♖","♘","♗","♕","♔","♗","♘","♖"]]),[i,u]=(0,r.useState)(null),[d,p]=(0,r.useState)(null),[m,w]=(0,r.useState)(null),[b,k]=(0,r.useState)([]),[v,g]=(0,r.useState)(null),N=(0,r.useRef)(null),[j,S]=(0,r.useState)({}),[M,C]=(0,r.useState)(null),[O,T]=(0,r.useState)([]),[q,P]=(0,r.useState)("white"),[_,E]=(0,r.useState)(600),[F,R]=(0,r.useState)(600),B=(0,r.useRef)(null),[G,I]=(0,r.useState)([]),[H,L]=(0,r.useState)([]),[Y,U]=(0,r.useState)([]),W=l?[1,2,3,4,5,6,7,8]:[8,7,6,5,4,3,2,1],z=l?["h","g","f","e","d","c","b","a"]:["a","b","c","d","e","f","g","h"],A=(e,t)=>({actualRow:l?7-e:e,actualCol:l?7-t:t}),D=(e,l)=>b.some(t=>t.x===l&&t.y===e);function J(e){return{board:e,moveHistory:O,hasMoved:j,enPassantTarget:M}}function K(e){let l=Math.floor(e/60);return"".concat(l,":").concat((e%60).toString().padStart(2,"0"))}(0,r.useEffect)(()=>{if(B.current&&clearInterval(B.current),c)return B.current=setInterval(()=>{"white"===q?E(e=>e>0?e-1:0):R(e=>e>0?e-1:0)},1e3),()=>{B.current&&clearInterval(B.current)}},[q,c]);let Q=t?(e,l)=>{var t,n;let{actualRow:r,actualCol:c}=A(e,l);if(!i){let e=null===(n=a[r])||void 0===n?void 0:n[c];if(!e){w({row:r,col:c}),k([]);return}let l=y[e];if(l.color!==q)return;u({row:r,col:c}),p({from:{row:r,col:c},to:{row:r,col:c}}),w(null);let t=f(a),o=J(t);k(x[l.type]({x:c,y:r},t,l.color,o));return}let{row:d,col:m}=i,b=a[d][m];if(!b){u(null),k([]);return}let v=y[b];if(v.color!==q){u(null),k([]);return}if(D(r,c)){if(function(e,l,t,n,r){let c=n.map(e=>[...e]),o=c[e.row][e.col];"king"===t.type&&2===Math.abs(l.col-e.col)?6===l.col?(c[e.row][4]=null,c[e.row][6]=o,c[e.row][7]=null,c[e.row][5]="white"===t.color?"♖":"♜"):2===l.col&&(c[e.row][4]=null,c[e.row][2]=o,c[e.row][0]=null,c[e.row][3]="white"===t.color?"♖":"♜"):"pawn"===t.type&&r&&l.col===r.x&&l.row===r.y?(c[l.row][l.col]=o,c[e.row][e.col]=null,c[e.row][l.col]=null):(c[l.row][l.col]=o,c[e.row][e.col]=null);let a="white"===t.color?"♔":"♚",s=null;for(let e=0;e<8;e++)for(let l=0;l<8;l++)c[e][l]===a&&(s={x:l,y:e});return"king"===t.type&&(s={x:l.col,y:l.row}),!s||h(s,f(c),"white"===t.color?"black":"white")}({row:d,col:m},{row:r,col:c},v,a,M)){g({row:d,col:m}),N.current&&clearTimeout(N.current),N.current=setTimeout(()=>{g(null)},1200);return}let e=a[d][m],l=e?y[e]:null,t=!1,n=null,i=null;l&&"king"===l.type&&2===Math.abs(c-m)&&(t=!0,6===c?(n={x:7,y:d},i={x:5,y:d}):2===c&&(n={x:0,y:d},i={x:3,y:d}));let x=!1,b=null;l&&"pawn"===l.type&&M&&c===M.x&&r===M.y&&(x=!0,b={row:d,col:c});let _=a.map(e=>[...e]);t&&n&&i?(_[r][c]=a[d][m],_[d][m]=null,_[i.y][i.x]=a[n.y][n.x],_[n.y][n.x]=null):x&&b?(_[r][c]=a[d][m],_[d][m]=null,_[b.row][b.col]=null):(_[r][c]=a[d][m],_[d][m]=null);let E={...j};l&&(E["".concat(m,",").concat(d)]=!0,t&&n&&(E["".concat(n.x,",").concat(n.y)]=!0));let F=null;l&&"pawn"===l.type&&2===Math.abs(r-d)&&(F={x:m,y:(d+r)/2});let R={from:{x:m,y:d},to:{x:c,y:r},piece:l,isCastling:t,isEnPassant:x,captured:x&&b?a[b.row][b.col]?y[a[b.row][b.col]]:null:a[r][c]?y[a[r][c]]:null};s(_),S(E),C(F),T([...O,R]),p({from:{row:d,col:m},to:{row:r,col:c}}),u(null),w(null),k([]),function(e){let l="white"===e.piece.color;I(t=>{let n=function(e,l,t){if(e.isCastling){if(6===e.to.x)return"O-O";if(2===e.to.x)return"O-O-O"}let n="abcdefgh",r="pawn"===e.piece.type?"":e.piece.type[0].toUpperCase(),c=e.captured?"x":"",o=n[e.to.x]+(8-e.to.y);return"pawn"===e.piece.type&&e.captured?n[e.from.x]+"x"+o:r+c+o}(e,Math.floor(t.length/2),0);if(l)return[...t,{white:n}];{if(0===t.length)return[{black:n}];let e=t[t.length-1];return[...t.slice(0,-1),{...e,black:n}]}})}(R),function(e){if(e.captured&&e.captured.type){let l={white:{pawn:"♙",rook:"♖",knight:"♘",bishop:"♗",queen:"♕",king:"♔"},black:{pawn:"♟",rook:"♜",knight:"♞",bishop:"♝",queen:"♛",king:"♚"}}[e.captured.color][e.captured.type];"white"===e.piece.color?U(e=>[...e,l]):L(e=>[...e,l])}}(R),P("white"===q?"black":"white"),o&&o()}else if(null===(t=a[r])||void 0===t?void 0:t[c]){let e=a[r][c];if(!e)return;let l=y[e];if(l.color!==q)return;u({row:r,col:c}),p({from:{row:r,col:c},to:{row:r,col:c}}),w(null);let t=f(a),n=J(t);k(x[l.type]({x:c,y:r},t,l.color,n))}else i&&(g({row:i.row,col:i.col}),N.current&&clearTimeout(N.current),N.current=setTimeout(()=>{g(null)},1200)),u(null),w({row:r,col:c}),k([])}:()=>{};return(0,n.jsxs)("div",{className:"chess-layout",children:[(0,n.jsx)("div",{className:"chessboard-panel",children:(0,n.jsx)("div",{className:"chess-container",children:(0,n.jsx)("div",{className:"chess-board".concat(t?"":" disabled"),children:(l?[...a].reverse():a).map((e,t)=>(l?[...e].reverse():e).map((e,l)=>{let{actualRow:r,actualCol:c}=A(t,l),o=d&&d.from.row===r&&d.from.col===c,a=d&&d.to.row===r&&d.to.col===c,s=m&&m.row===r&&m.col===c,u=i&&D(r,c),p=v&&v.row===r&&v.col===c;return(0,n.jsxs)("div",{className:"chess-square ".concat((t+l)%2==0?"light":"dark"," ").concat(o||a?"green-highlight":""," ").concat(s?"yellow-highlight":""," ").concat(u?"highlight":""," ").concat(p?"red-blink":""),onClick:()=>Q(t,l),children:[e&&(0,n.jsx)("span",{className:"chess-piece",children:e}),0===l&&(0,n.jsx)("span",{className:"row-label",children:W[t]}),7===t&&(0,n.jsx)("span",{className:"column-label",children:z[l]})]},"".concat(t,"-").concat(l))}))})})}),(0,n.jsxs)("div",{className:"info-panel",children:[(0,n.jsx)("div",{className:"info-left",children:l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"clock player-clock",children:["You: ",K(_)]}),(0,n.jsx)("div",{className:"captured-pieces captured-by-player",children:0===Y.length?(0,n.jsx)("span",{className:"captured-placeholder",children:"No captures"}):Y.map((e,l)=>(0,n.jsx)("span",{className:"captured-piece",children:e},l))}),(0,n.jsx)("div",{className:"info-separator"}),(0,n.jsx)("div",{className:"captured-pieces captured-by-opponent",children:0===H.length?(0,n.jsx)("span",{className:"captured-placeholder",children:"No captures"}):H.map((e,l)=>(0,n.jsx)("span",{className:"captured-piece",children:e},l))}),(0,n.jsxs)("div",{className:"clock opponent-clock",children:["Opponent: ",K(F)]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"clock opponent-clock",children:["Opponent: ",K(F)]}),(0,n.jsx)("div",{className:"captured-pieces captured-by-opponent",children:0===H.length?(0,n.jsx)("span",{className:"captured-placeholder",children:"No captures"}):H.map((e,l)=>(0,n.jsx)("span",{className:"captured-piece",children:e},l))}),(0,n.jsx)("div",{className:"info-separator"}),(0,n.jsx)("div",{className:"captured-pieces captured-by-player",children:0===Y.length?(0,n.jsx)("span",{className:"captured-placeholder",children:"No captures"}):Y.map((e,l)=>(0,n.jsx)("span",{className:"captured-piece",children:e},l))}),(0,n.jsxs)("div",{className:"clock player-clock",children:["You: ",K(_)]})]})}),(0,n.jsxs)("div",{className:"info-right",children:[(0,n.jsx)("div",{className:"move-list-title",children:"Move List"}),(0,n.jsx)("div",{className:"move-list",children:G.map((e,l)=>(0,n.jsx)("div",{className:"move-list-row",children:"".concat(l+1,". ").concat(e.white||"").concat(e.black?" "+e.black:"")},l))})]})]})]})};function w(e){let{gameMode:l,onBack:t}=e,[c,o]=(0,r.useState)(!1),[a,s]=(0,r.useState)(!1);return(0,n.jsxs)("div",{className:"game-page",children:[(0,n.jsxs)("div",{className:"game-header-fixed",children:[(0,n.jsx)("button",{className:"back-btn",onClick:t,children:"← Back"}),(0,n.jsx)("span",{className:"game-title",children:"Chess Game"}),(0,n.jsx)("div",{})]}),(0,n.jsxs)("div",{className:"button-row",children:[(0,n.jsx)("button",{className:"main-action-btn",onClick:()=>o(e=>!e),children:c?"Stop Game":"Start Game"}),(0,n.jsx)("button",{className:"main-action-btn",onClick:()=>s(e=>!e),children:"Flip Board"})]}),(0,n.jsx)("div",{className:"game-board-area",children:(0,n.jsx)(m,{isFlipped:a,boardEnabled:c,gameStarted:c,onMove:()=>{"pass"===l&&s(e=>!e)},gameMode:l})})]})}function b(){let[e,l]=(0,r.useState)("start"),[t,o]=(0,r.useState)("friend");return(0,n.jsxs)("div",{className:"app-root",children:["start"===e&&(0,n.jsx)(c,{onSelectMode:e=>{o(e),l("game")}}),"game"===e&&(0,n.jsx)(w,{gameMode:t,onBack:()=>l("start")})]})}t(5399)},8227:(e,l,t)=>{Promise.resolve().then(t.bind(t,8059))},9289:()=>{}},e=>{var l=l=>e(e.s=l);e.O(0,[505,441,684,358],()=>l(8227)),_N_E=e.O()}]);