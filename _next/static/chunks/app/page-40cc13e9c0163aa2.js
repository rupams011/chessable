(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3520:()=>{},5399:()=>{},8059:(e,l,t)=>{"use strict";t.r(l),t.d(l,{default:()=>b});var a=t(5155),n=t(2115);function r(e){let{onSelectMode:l}=e,t=(0,n.useRef)(null);function r(e){t.current?(t.current.classList.add("fade-out"),setTimeout(()=>l(e),300)):l(e)}return(0,a.jsxs)("div",{className:"start-page fade-in",ref:t,children:[(0,a.jsx)("h1",{className:"start-title",children:"Let's play a game of Chess"}),(0,a.jsxs)("div",{className:"start-buttons",children:[(0,a.jsx)("button",{className:"start-btn friend",onClick:()=>r("friend"),children:"Play a Friend Online"}),(0,a.jsx)("button",{className:"start-btn pass",onClick:()=>r("pass"),children:"Pass and Play"})]})]})}function c(e){return e.x>=0&&e.x<8&&e.y>=0&&e.y<8}function o(e,l,t){if(!c(l))return!1;let a=e[l.y][l.x];return!a||a.color!==t}function s(e,l,t){let a=[];for(let{dx:n,dy:r}of[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1}]){let o=e.x+n,s=e.y+r;for(;c({x:o,y:s});){let e=l[s][o];if(e){e.color!==t&&a.push({x:o,y:s});break}a.push({x:o,y:s}),o+=n,s+=r}}return a}function i(e,l,t){let a=[];for(let{dx:n,dy:r}of[{dx:1,dy:2},{dx:2,dy:1},{dx:-1,dy:2},{dx:-2,dy:1},{dx:1,dy:-2},{dx:2,dy:-1},{dx:-1,dy:-2},{dx:-2,dy:-1}]){let c={x:e.x+n,y:e.y+r};o(l,c,t)&&a.push(c)}return a}function u(e,l,t){let a=[];for(let{dx:n,dy:r}of[{dx:1,dy:1},{dx:1,dy:-1},{dx:-1,dy:1},{dx:-1,dy:-1}]){let o=e.x+n,s=e.y+r;for(;c({x:o,y:s});){let e=l[s][o];if(e){e.color!==t&&a.push({x:o,y:s});break}a.push({x:o,y:s}),o+=n,s+=r}}return a}function d(e,l,t){return[...s(e,l,t),...u(e,l,t)]}function p(e,l,t){let a=[];for(let{dx:n,dy:r}of[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1},{dx:1,dy:1},{dx:1,dy:-1},{dx:-1,dy:1},{dx:-1,dy:-1}]){let c={x:e.x+n,y:e.y+r};o(l,c,t)&&a.push(c)}return a}function h(e,l,t){for(let a=0;a<8;a++)for(let n=0;n<8;n++){let r=l[a][n];if(r&&r.color===t){let c=[];switch(r.type){case"pawn":let o="white"===t?-1:1;for(let l of[-1,1])if(n+l===e.x&&a+o===e.y)return!0;break;case"rook":c=s({x:n,y:a},l,t);break;case"knight":c=i({x:n,y:a},l,t);break;case"bishop":c=u({x:n,y:a},l,t);break;case"queen":c=d({x:n,y:a},l,t);break;case"king":c=p({x:n,y:a},l,t)}if(c.some(l=>l.x===e.x&&l.y===e.y))return!0}}return!1}t(9289),t(3520);let x={pawn:(e,l,t,a)=>a?function(e,l,t,a){let n=[],r="white"===t?-1:1,o="white"===t?6:1,s={x:e.x,y:e.y+r};if(c(s)&&!l[s.y][s.x]){n.push(s);let t={x:e.x,y:e.y+2*r};e.y!==o||l[t.y][t.x]||l[s.y][s.x]||n.push(t)}for(let o of[-1,1]){var i;let s={x:e.x+o,y:e.y+r};c(s)&&l[s.y][s.x]&&(null===(i=l[s.y][s.x])||void 0===i?void 0:i.color)!==t&&n.push(s),function(e,l,t,a){if(!t.enPassantTarget||t.enPassantTarget.x!==l.x||t.enPassantTarget.y!==l.y||e.y!==("white"===a?3:4)||1!==Math.abs(e.x-l.x)||l.y!==e.y+("white"===a?-1:1))return!1;let n=t.moveHistory[t.moveHistory.length-1];return!!n&&"pawn"===n.piece.type&&2===Math.abs(n.from.y-n.to.y)&&n.to.x===l.x&&n.to.y===e.y}(e,s,a,t)&&n.push(s)}return n}(e,l,t,a):function(e,l,t){let a=[],n="white"===t?-1:1,r={x:e.x,y:e.y+n};if(c(r)&&!l[r.y][r.x]){a.push(r);let c={x:e.x,y:e.y+2*n};e.y!==("white"===t?6:1)||l[c.y][c.x]||a.push(c)}for(let r of[-1,1]){var o;let s={x:e.x+r,y:e.y+n};c(s)&&l[s.y][s.x]&&(null===(o=l[s.y][s.x])||void 0===o?void 0:o.color)!==t&&a.push(s)}return a}(e,l,t),rook:s,knight:i,bishop:u,queen:d,king:(e,l,t,a)=>a?function(e,l,t,a){let n=[];for(let{dx:a,dy:r}of[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1},{dx:1,dy:1},{dx:1,dy:-1},{dx:-1,dy:1},{dx:-1,dy:-1}]){let c={x:e.x+a,y:e.y+r};o(l,c,t)&&n.push(c)}return("white"===t&&4===e.x&&7===e.y||"black"===t&&4===e.x&&0===e.y)&&(function(e,l){let t=7*("white"===e),a="".concat(4,",").concat(t),n="".concat(7,",").concat(t);if(l.hasMoved[a]||l.hasMoved[n])return!1;for(let e=5;e<7;e++)if(l.board[t][e])return!1;for(let a=4;a<=6;a++)if(h({x:a,y:t},l.board,"white"===e?"black":"white"))return!1;return!0}(t,a)&&n.push({x:6,y:e.y}),function(e,l){let t=7*("white"===e),a="".concat(4,",").concat(t),n="".concat(0,",").concat(t);if(l.hasMoved[a]||l.hasMoved[n])return!1;for(let e=1;e<4;e++)if(l.board[t][e])return!1;for(let a=2;a<=4;a++)if(h({x:a,y:t},l.board,"white"===e?"black":"white"))return!1;return!0}(t,a)&&n.push({x:2,y:e.y})),n}(e,l,t,a):p(e,l,t)},y={"♙":{type:"pawn",color:"white"},"♖":{type:"rook",color:"white"},"♘":{type:"knight",color:"white"},"♗":{type:"bishop",color:"white"},"♕":{type:"queen",color:"white"},"♔":{type:"king",color:"white"},"♟":{type:"pawn",color:"black"},"♜":{type:"rook",color:"black"},"♞":{type:"knight",color:"black"},"♝":{type:"bishop",color:"black"},"♛":{type:"queen",color:"black"},"♚":{type:"king",color:"black"}};function f(e){return e.map(e=>e.map(e=>e?{...y[e]}:null))}let m=e=>{let{isFlipped:l,boardEnabled:t,gameStarted:r,onMove:c,onTimerZero:o,playerName:s="White",opponentName:i="Black",initialMinutes:u=10}=e,[d,p]=(0,n.useState)([["♜","♞","♝","♛","♚","♝","♞","♜"],["♟","♟","♟","♟","♟","♟","♟","♟"],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],["♙","♙","♙","♙","♙","♙","♙","♙"],["♖","♘","♗","♕","♔","♗","♘","♖"]]),[m,w]=(0,n.useState)(null),[b,k]=(0,n.useState)(null),[g,v]=(0,n.useState)(null),[N,j]=(0,n.useState)([]),[S,M]=(0,n.useState)(null),C=(0,n.useRef)(null),[T,B]=(0,n.useState)({}),[O,q]=(0,n.useState)(null),[E,F]=(0,n.useState)([]),[P,_]=(0,n.useState)("white"),L=60*u,[W,R]=(0,n.useState)(L),[G,I]=(0,n.useState)(L),H=(0,n.useRef)(null),[A,U]=(0,n.useState)([]),[Z,z]=(0,n.useState)([]),[D,J]=(0,n.useState)([]),K=l?[1,2,3,4,5,6,7,8]:[8,7,6,5,4,3,2,1],Q=l?["h","g","f","e","d","c","b","a"]:["a","b","c","d","e","f","g","h"],V=(e,t)=>({actualRow:l?7-e:e,actualCol:l?7-t:t}),X=(e,l)=>N.some(t=>t.x===l&&t.y===e);function Y(e){return{board:e,moveHistory:E,hasMoved:T,enPassantTarget:O}}function $(e){let l=Math.floor(e/60);return"".concat(l,":").concat((e%60).toString().padStart(2,"0"))}(0,n.useEffect)(()=>{if(r)return H.current&&clearInterval(H.current),H.current=setInterval(()=>{"white"===P?R(e=>e>0?e-1:0):I(e=>e>0?e-1:(0===e&&o&&o("black"),0))},1e3),()=>{H.current&&clearInterval(H.current)}},[P,r,o]),(0,n.useEffect)(()=>{r&&(R(60*u),I(60*u))},[r,u]),(0,n.useEffect)(()=>{0===W&&r&&o&&o("white"),0===G&&r&&o&&o("black")},[W,G,r]);let ee=t?(e,l)=>{var t,a;let{actualRow:n,actualCol:r}=V(e,l);if(!m){let e=null===(a=d[n])||void 0===a?void 0:a[r];if(!e){v({row:n,col:r}),j([]);return}let l=y[e];if(l.color!==P)return;w({row:n,col:r}),k({from:{row:n,col:r},to:{row:n,col:r}}),v(null);let t=f(d),c=Y(t);j(x[l.type]({x:r,y:n},t,l.color,c));return}let{row:o,col:s}=m,i=d[o][s];if(!i){w(null),j([]);return}let u=y[i];if(u.color!==P){w(null),j([]);return}if(X(n,r)){if(function(e,l,t,a,n){let r=a.map(e=>[...e]),c=r[e.row][e.col];"king"===t.type&&2===Math.abs(l.col-e.col)?6===l.col?(r[e.row][4]=null,r[e.row][6]=c,r[e.row][7]=null,r[e.row][5]="white"===t.color?"♖":"♜"):2===l.col&&(r[e.row][4]=null,r[e.row][2]=c,r[e.row][0]=null,r[e.row][3]="white"===t.color?"♖":"♜"):"pawn"===t.type&&n&&l.col===n.x&&l.row===n.y?(r[l.row][l.col]=c,r[e.row][e.col]=null,r[e.row][l.col]=null):(r[l.row][l.col]=c,r[e.row][e.col]=null);let o="white"===t.color?"♔":"♚",s=null;for(let e=0;e<8;e++)for(let l=0;l<8;l++)r[e][l]===o&&(s={x:l,y:e});return"king"===t.type&&(s={x:l.col,y:l.row}),!s||h(s,f(r),"white"===t.color?"black":"white")}({row:o,col:s},{row:n,col:r},u,d,O)){M({row:o,col:s}),C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{M(null)},1200);return}let e=d[o][s],l=e?y[e]:null,t=!1,a=null,i=null;l&&"king"===l.type&&2===Math.abs(r-s)&&(t=!0,6===r?(a={x:7,y:o},i={x:5,y:o}):2===r&&(a={x:0,y:o},i={x:3,y:o}));let x=!1,m=null;l&&"pawn"===l.type&&O&&r===O.x&&n===O.y&&(x=!0,m={row:o,col:r});let b=d.map(e=>[...e]);t&&a&&i?(b[n][r]=d[o][s],b[o][s]=null,b[i.y][i.x]=d[a.y][a.x],b[a.y][a.x]=null):x&&m?(b[n][r]=d[o][s],b[o][s]=null,b[m.row][m.col]=null):(b[n][r]=d[o][s],b[o][s]=null);let g={...T};l&&(g["".concat(s,",").concat(o)]=!0,t&&a&&(g["".concat(a.x,",").concat(a.y)]=!0));let N=null;l&&"pawn"===l.type&&2===Math.abs(n-o)&&(N={x:s,y:(o+n)/2});let S={from:{x:s,y:o},to:{x:r,y:n},piece:l,isCastling:t,isEnPassant:x,captured:x&&m?d[m.row][m.col]?y[d[m.row][m.col]]:null:d[n][r]?y[d[n][r]]:null};p(b),B(g),q(N),F([...E,S]),k({from:{row:o,col:s},to:{row:n,col:r}}),w(null),v(null),j([]),function(e){let l="white"===e.piece.color;U(t=>{let a=function(e,l,t){if(e.isCastling){if(6===e.to.x)return"O-O";if(2===e.to.x)return"O-O-O"}let a="abcdefgh",n="pawn"===e.piece.type?"":e.piece.type[0].toUpperCase(),r=e.captured?"x":"",c=a[e.to.x]+(8-e.to.y);return"pawn"===e.piece.type&&e.captured?a[e.from.x]+"x"+c:n+r+c}(e,Math.floor(t.length/2),0);if(l)return[...t,{white:a}];{if(0===t.length)return[{black:a}];let e=t[t.length-1];return[...t.slice(0,-1),{...e,black:a}]}})}(S),function(e){if(e.captured&&e.captured.type){let l={white:{pawn:"♙",rook:"♖",knight:"♘",bishop:"♗",queen:"♕",king:"♔"},black:{pawn:"♟",rook:"♜",knight:"♞",bishop:"♝",queen:"♛",king:"♚"}}[e.captured.color][e.captured.type];"white"===e.piece.color?J(e=>[...e,l]):z(e=>[...e,l])}}(S),_("white"===P?"black":"white"),c&&c()}else if(null===(t=d[n])||void 0===t?void 0:t[r]){let e=d[n][r];if(!e)return;let l=y[e];if(l.color!==P)return;w({row:n,col:r}),k({from:{row:n,col:r},to:{row:n,col:r}}),v(null);let t=f(d),a=Y(t);j(x[l.type]({x:r,y:n},t,l.color,a))}else m&&(M({row:m.row,col:m.col}),C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{M(null)},1200)),w(null),v({row:n,col:r}),j([])}:()=>{};return(0,a.jsxs)("div",{className:"chess-layout",children:[(0,a.jsx)("div",{className:"chessboard-panel",children:(0,a.jsx)("div",{className:"chess-container",children:(0,a.jsx)("div",{className:"chess-board".concat(t?"":" disabled"),children:(l?[...d].reverse():d).map((e,t)=>(l?[...e].reverse():e).map((e,l)=>{let{actualRow:n,actualCol:r}=V(t,l),c=b&&b.from.row===n&&b.from.col===r,o=b&&b.to.row===n&&b.to.col===r,s=g&&g.row===n&&g.col===r,i=m&&X(n,r),u=S&&S.row===n&&S.col===r;return(0,a.jsxs)("div",{className:"chess-square ".concat((t+l)%2==0?"light":"dark"," ").concat(c||o?"green-highlight":""," ").concat(s?"yellow-highlight":""," ").concat(i?"highlight":""," ").concat(u?"red-blink":""),onClick:()=>ee(t,l),children:[e&&(0,a.jsx)("span",{className:"chess-piece",children:e}),0===l&&(0,a.jsx)("span",{className:"row-label",children:K[t]}),7===t&&(0,a.jsx)("span",{className:"column-label",children:Q[l]})]},"".concat(t,"-").concat(l))}))})})}),(0,a.jsxs)("div",{className:"info-panel",children:[(0,a.jsx)("div",{className:"info-left",children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"clock player-clock",children:[s,": ",$(W)]}),(0,a.jsx)("div",{className:"captured-pieces captured-by-player",children:0===D.length?(0,a.jsx)("span",{className:"captured-placeholder",children:"No captures"}):D.map((e,l)=>(0,a.jsx)("span",{className:"captured-piece",children:e},l))}),(0,a.jsx)("div",{className:"info-separator"}),(0,a.jsx)("div",{className:"captured-pieces captured-by-opponent",children:0===Z.length?(0,a.jsx)("span",{className:"captured-placeholder",children:"No captures"}):Z.map((e,l)=>(0,a.jsx)("span",{className:"captured-piece",children:e},l))}),(0,a.jsxs)("div",{className:"clock opponent-clock",children:[i,": ",$(G)]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"clock opponent-clock",children:[i,": ",$(G)]}),(0,a.jsx)("div",{className:"captured-pieces captured-by-opponent",children:0===Z.length?(0,a.jsx)("span",{className:"captured-placeholder",children:"No captures"}):Z.map((e,l)=>(0,a.jsx)("span",{className:"captured-piece",children:e},l))}),(0,a.jsx)("div",{className:"info-separator"}),(0,a.jsx)("div",{className:"captured-pieces captured-by-player",children:0===D.length?(0,a.jsx)("span",{className:"captured-placeholder",children:"No captures"}):D.map((e,l)=>(0,a.jsx)("span",{className:"captured-piece",children:e},l))}),(0,a.jsxs)("div",{className:"clock player-clock",children:[s,": ",$(W)]})]})}),(0,a.jsxs)("div",{className:"info-right",children:[(0,a.jsx)("div",{className:"move-list-title",children:"Move List"}),(0,a.jsx)("div",{className:"move-list",children:A.map((e,l)=>(0,a.jsx)("div",{className:"move-list-row",children:"".concat(l+1,". ").concat(e.white||"").concat(e.black?" "+e.black:"")},l))})]})]})]})};function w(e){let{gameMode:l,onBack:t}=e,[r,c]=(0,n.useState)(!1),[o,s]=(0,n.useState)(!1),[i,u]=(0,n.useState)(!0),[d,p]=(0,n.useState)(null),[h,x]=(0,n.useState)("White"),[y,f]=(0,n.useState)("Black"),[w,b]=(0,n.useState)(10),[k,g]=(0,n.useState)("White"),[v,N]=(0,n.useState)("Black"),[j,S]=(0,n.useState)(10),[M,C]=(0,n.useState)(!1),T=()=>{M||(g(h.trim()||"White"),N(y.trim()||"Black"),S(w),C(!0)),c(!0),p(null)};return(0,a.jsxs)("div",{className:"game-page",children:[(0,a.jsxs)("div",{className:"game-header-fixed",children:[(0,a.jsx)("button",{className:"back-btn",onClick:t,children:"← Back"}),(0,a.jsx)("span",{className:"game-title",children:"Chess Game"}),(0,a.jsx)("div",{})]}),(0,a.jsxs)("div",{className:"button-row",children:[!M&&(0,a.jsxs)("div",{className:"edit-fields",children:[(0,a.jsx)("input",{className:"edit-input",value:h,onChange:e=>x(e.target.value),placeholder:"White player name",maxLength:16}),(0,a.jsx)("input",{className:"edit-input",value:y,onChange:e=>f(e.target.value),placeholder:"Black player name",maxLength:16}),(0,a.jsx)("input",{className:"edit-input",type:"number",min:1,max:60,value:w,onChange:e=>b(Number(e.target.value)),style:{width:70},"aria-label":"Minutes per player"}),(0,a.jsx)("span",{className:"edit-label",children:"min"})]}),(0,a.jsx)("button",{className:"main-action-btn",onClick:()=>{r?c(!1):T()},disabled:!!d,children:r?"Stop Game":"Start Game"}),(0,a.jsx)("button",{className:"main-action-btn",onClick:()=>s(e=>!e),children:"Flip Board"}),(0,a.jsxs)("label",{className:"flip-toggle",children:[(0,a.jsx)("input",{type:"checkbox",checked:i,onChange:()=>u(e=>!e)}),(0,a.jsx)("span",{className:"flip-toggle-slider"}),(0,a.jsx)("span",{className:"flip-toggle-label",children:i?"Auto Flip":"Manual Flip"})]})]}),(0,a.jsxs)("div",{className:"game-board-area",style:{position:"relative"},children:[(0,a.jsx)(m,{isFlipped:o,boardEnabled:r&&!d,gameStarted:r,onMove:()=>{"pass"===l&&i&&s(e=>!e)},gameMode:l,onTimerZero:e=>{c(!1),p("white"===e?"black":"white")},playerName:k,opponentName:v,initialMinutes:j}),d&&(0,a.jsxs)("div",{className:"winner-label",children:["white"===d?k:v," wins on time!"]})]})]})}function b(){let[e,l]=(0,n.useState)("start"),[t,c]=(0,n.useState)("friend");return(0,a.jsxs)("div",{className:"app-root",children:["start"===e&&(0,a.jsx)(r,{onSelectMode:e=>{c(e),l("game")}}),"game"===e&&(0,a.jsx)(w,{gameMode:t,onBack:()=>l("start")})]})}t(5399)},8227:(e,l,t)=>{Promise.resolve().then(t.bind(t,8059))},9289:()=>{}},e=>{var l=l=>e(e.s=l);e.O(0,[505,441,684,358],()=>l(8227)),_N_E=e.O()}]);