(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3520:()=>{},5399:()=>{},8059:(e,l,t)=>{"use strict";t.r(l),t.d(l,{default:()=>b});var n=t(5155),r=t(2115);function c(e){let{onSelectMode:l}=e,t=(0,r.useRef)(null);function c(e){t.current?(t.current.classList.add("fade-out"),setTimeout(()=>l(e),300)):l(e)}return(0,n.jsxs)("div",{className:"start-page fade-in",ref:t,children:[(0,n.jsx)("h1",{className:"start-title",children:"Welcome to Modern Chess"}),(0,n.jsxs)("div",{className:"start-buttons",children:[(0,n.jsx)("button",{className:"start-btn friend",onClick:()=>c("friend"),children:"Play a Friend Online"}),(0,n.jsx)("button",{className:"start-btn pass",onClick:()=>c("pass"),children:"Pass and Play"})]})]})}function a(e){return e.x>=0&&e.x<8&&e.y>=0&&e.y<8}function o(e,l,t){if(!a(l))return!1;let n=e[l.y][l.x];return!n||n.color!==t}function s(e,l,t){let n=[];for(let{dx:r,dy:c}of[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1}]){let o=e.x+r,s=e.y+c;for(;a({x:o,y:s});){let e=l[s][o];if(e){e.color!==t&&n.push({x:o,y:s});break}n.push({x:o,y:s}),o+=r,s+=c}}return n}function i(e,l,t){let n=[];for(let{dx:r,dy:c}of[{dx:1,dy:2},{dx:2,dy:1},{dx:-1,dy:2},{dx:-2,dy:1},{dx:1,dy:-2},{dx:2,dy:-1},{dx:-1,dy:-2},{dx:-2,dy:-1}]){let a={x:e.x+r,y:e.y+c};o(l,a,t)&&n.push(a)}return n}function u(e,l,t){let n=[];for(let{dx:r,dy:c}of[{dx:1,dy:1},{dx:1,dy:-1},{dx:-1,dy:1},{dx:-1,dy:-1}]){let o=e.x+r,s=e.y+c;for(;a({x:o,y:s});){let e=l[s][o];if(e){e.color!==t&&n.push({x:o,y:s});break}n.push({x:o,y:s}),o+=r,s+=c}}return n}function d(e,l,t){return[...s(e,l,t),...u(e,l,t)]}function p(e,l,t){let n=[];for(let{dx:r,dy:c}of[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1},{dx:1,dy:1},{dx:1,dy:-1},{dx:-1,dy:1},{dx:-1,dy:-1}]){let a={x:e.x+r,y:e.y+c};o(l,a,t)&&n.push(a)}return n}function h(e,l,t){for(let n=0;n<8;n++)for(let r=0;r<8;r++){let c=l[n][r];if(c&&c.color===t){let a=[];switch(c.type){case"pawn":let o="white"===t?-1:1;for(let l of[-1,1])if(r+l===e.x&&n+o===e.y)return!0;break;case"rook":a=s({x:r,y:n},l,t);break;case"knight":a=i({x:r,y:n},l,t);break;case"bishop":a=u({x:r,y:n},l,t);break;case"queen":a=d({x:r,y:n},l,t);break;case"king":a=p({x:r,y:n},l,t)}if(a.some(l=>l.x===e.x&&l.y===e.y))return!0}}return!1}t(9289),t(3520);let x={pawn:(e,l,t,n)=>n?function(e,l,t,n){let r=[],c="white"===t?-1:1,o="white"===t?6:1,s={x:e.x,y:e.y+c};if(a(s)&&!l[s.y][s.x]){r.push(s);let t={x:e.x,y:e.y+2*c};e.y!==o||l[t.y][t.x]||l[s.y][s.x]||r.push(t)}for(let o of[-1,1]){var i;let s={x:e.x+o,y:e.y+c};a(s)&&l[s.y][s.x]&&(null===(i=l[s.y][s.x])||void 0===i?void 0:i.color)!==t&&r.push(s),function(e,l,t,n){if(!t.enPassantTarget||t.enPassantTarget.x!==l.x||t.enPassantTarget.y!==l.y||e.y!==("white"===n?3:4)||1!==Math.abs(e.x-l.x)||l.y!==e.y+("white"===n?-1:1))return!1;let r=t.moveHistory[t.moveHistory.length-1];return!!r&&"pawn"===r.piece.type&&2===Math.abs(r.from.y-r.to.y)&&r.to.x===l.x&&r.to.y===e.y}(e,s,n,t)&&r.push(s)}return r}(e,l,t,n):function(e,l,t){let n=[],r="white"===t?-1:1,c={x:e.x,y:e.y+r};if(a(c)&&!l[c.y][c.x]){n.push(c);let a={x:e.x,y:e.y+2*r};e.y!==("white"===t?6:1)||l[a.y][a.x]||n.push(a)}for(let c of[-1,1]){var o;let s={x:e.x+c,y:e.y+r};a(s)&&l[s.y][s.x]&&(null===(o=l[s.y][s.x])||void 0===o?void 0:o.color)!==t&&n.push(s)}return n}(e,l,t),rook:s,knight:i,bishop:u,queen:d,king:(e,l,t,n)=>n?function(e,l,t,n){let r=[];for(let{dx:n,dy:c}of[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1},{dx:1,dy:1},{dx:1,dy:-1},{dx:-1,dy:1},{dx:-1,dy:-1}]){let a={x:e.x+n,y:e.y+c};o(l,a,t)&&r.push(a)}return("white"===t&&4===e.x&&7===e.y||"black"===t&&4===e.x&&0===e.y)&&(function(e,l){let t=7*("white"===e),n="".concat(4,",").concat(t),r="".concat(7,",").concat(t);if(l.hasMoved[n]||l.hasMoved[r])return!1;for(let e=5;e<7;e++)if(l.board[t][e])return!1;for(let n=4;n<=6;n++)if(h({x:n,y:t},l.board,"white"===e?"black":"white"))return!1;return!0}(t,n)&&r.push({x:6,y:e.y}),function(e,l){let t=7*("white"===e),n="".concat(4,",").concat(t),r="".concat(0,",").concat(t);if(l.hasMoved[n]||l.hasMoved[r])return!1;for(let e=1;e<4;e++)if(l.board[t][e])return!1;for(let n=2;n<=4;n++)if(h({x:n,y:t},l.board,"white"===e?"black":"white"))return!1;return!0}(t,n)&&r.push({x:2,y:e.y})),r}(e,l,t,n):p(e,l,t)},y={"♙":{type:"pawn",color:"white"},"♖":{type:"rook",color:"white"},"♘":{type:"knight",color:"white"},"♗":{type:"bishop",color:"white"},"♕":{type:"queen",color:"white"},"♔":{type:"king",color:"white"},"♟":{type:"pawn",color:"black"},"♜":{type:"rook",color:"black"},"♞":{type:"knight",color:"black"},"♝":{type:"bishop",color:"black"},"♛":{type:"queen",color:"black"},"♚":{type:"king",color:"black"}};function f(e){return e.map(e=>e.map(e=>e?{...y[e]}:null))}let m=e=>{let{isFlipped:l,boardEnabled:t,gameStarted:c,onMove:a,onTimerZero:o}=e,[s,i]=(0,r.useState)([["♜","♞","♝","♛","♚","♝","♞","♜"],["♟","♟","♟","♟","♟","♟","♟","♟"],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],["♙","♙","♙","♙","♙","♙","♙","♙"],["♖","♘","♗","♕","♔","♗","♘","♖"]]),[u,d]=(0,r.useState)(null),[p,m]=(0,r.useState)(null),[w,b]=(0,r.useState)(null),[k,v]=(0,r.useState)([]),[g,j]=(0,r.useState)(null),N=(0,r.useRef)(null),[S,M]=(0,r.useState)({}),[C,O]=(0,r.useState)(null),[T,q]=(0,r.useState)([]),[F,P]=(0,r.useState)("white"),[_,E]=(0,r.useState)(600),[B,R]=(0,r.useState)(600),G=(0,r.useRef)(null),[I,H]=(0,r.useState)([]),[L,W]=(0,r.useState)([]),[Y,A]=(0,r.useState)([]),U=l?[1,2,3,4,5,6,7,8]:[8,7,6,5,4,3,2,1],Z=l?["h","g","f","e","d","c","b","a"]:["a","b","c","d","e","f","g","h"],z=(e,t)=>({actualRow:l?7-e:e,actualCol:l?7-t:t}),D=(e,l)=>k.some(t=>t.x===l&&t.y===e);function J(e){return{board:e,moveHistory:T,hasMoved:S,enPassantTarget:C}}function K(e){let l=Math.floor(e/60);return"".concat(l,":").concat((e%60).toString().padStart(2,"0"))}(0,r.useEffect)(()=>{if(c)return G.current&&clearInterval(G.current),G.current=setInterval(()=>{"white"===F?E(e=>e>0?e-1:(0===e&&o&&o("white"),0)):R(e=>e>0?e-1:(0===e&&o&&o("black"),0))},1e3),()=>{G.current&&clearInterval(G.current)}},[F,c,o]);let Q=t?(e,l)=>{var t,n;let{actualRow:r,actualCol:c}=z(e,l);if(!u){let e=null===(n=s[r])||void 0===n?void 0:n[c];if(!e){b({row:r,col:c}),v([]);return}let l=y[e];if(l.color!==F)return;d({row:r,col:c}),m({from:{row:r,col:c},to:{row:r,col:c}}),b(null);let t=f(s),a=J(t);v(x[l.type]({x:c,y:r},t,l.color,a));return}let{row:o,col:p}=u,w=s[o][p];if(!w){d(null),v([]);return}let k=y[w];if(k.color!==F){d(null),v([]);return}if(D(r,c)){if(function(e,l,t,n,r){let c=n.map(e=>[...e]),a=c[e.row][e.col];"king"===t.type&&2===Math.abs(l.col-e.col)?6===l.col?(c[e.row][4]=null,c[e.row][6]=a,c[e.row][7]=null,c[e.row][5]="white"===t.color?"♖":"♜"):2===l.col&&(c[e.row][4]=null,c[e.row][2]=a,c[e.row][0]=null,c[e.row][3]="white"===t.color?"♖":"♜"):"pawn"===t.type&&r&&l.col===r.x&&l.row===r.y?(c[l.row][l.col]=a,c[e.row][e.col]=null,c[e.row][l.col]=null):(c[l.row][l.col]=a,c[e.row][e.col]=null);let o="white"===t.color?"♔":"♚",s=null;for(let e=0;e<8;e++)for(let l=0;l<8;l++)c[e][l]===o&&(s={x:l,y:e});return"king"===t.type&&(s={x:l.col,y:l.row}),!s||h(s,f(c),"white"===t.color?"black":"white")}({row:o,col:p},{row:r,col:c},k,s,C)){j({row:o,col:p}),N.current&&clearTimeout(N.current),N.current=setTimeout(()=>{j(null)},1200);return}let e=s[o][p],l=e?y[e]:null,t=!1,n=null,u=null;l&&"king"===l.type&&2===Math.abs(c-p)&&(t=!0,6===c?(n={x:7,y:o},u={x:5,y:o}):2===c&&(n={x:0,y:o},u={x:3,y:o}));let x=!1,w=null;l&&"pawn"===l.type&&C&&c===C.x&&r===C.y&&(x=!0,w={row:o,col:c});let g=s.map(e=>[...e]);t&&n&&u?(g[r][c]=s[o][p],g[o][p]=null,g[u.y][u.x]=s[n.y][n.x],g[n.y][n.x]=null):x&&w?(g[r][c]=s[o][p],g[o][p]=null,g[w.row][w.col]=null):(g[r][c]=s[o][p],g[o][p]=null);let _={...S};l&&(_["".concat(p,",").concat(o)]=!0,t&&n&&(_["".concat(n.x,",").concat(n.y)]=!0));let E=null;l&&"pawn"===l.type&&2===Math.abs(r-o)&&(E={x:p,y:(o+r)/2});let B={from:{x:p,y:o},to:{x:c,y:r},piece:l,isCastling:t,isEnPassant:x,captured:x&&w?s[w.row][w.col]?y[s[w.row][w.col]]:null:s[r][c]?y[s[r][c]]:null};i(g),M(_),O(E),q([...T,B]),m({from:{row:o,col:p},to:{row:r,col:c}}),d(null),b(null),v([]),function(e){let l="white"===e.piece.color;H(t=>{let n=function(e,l,t){if(e.isCastling){if(6===e.to.x)return"O-O";if(2===e.to.x)return"O-O-O"}let n="abcdefgh",r="pawn"===e.piece.type?"":e.piece.type[0].toUpperCase(),c=e.captured?"x":"",a=n[e.to.x]+(8-e.to.y);return"pawn"===e.piece.type&&e.captured?n[e.from.x]+"x"+a:r+c+a}(e,Math.floor(t.length/2),0);if(l)return[...t,{white:n}];{if(0===t.length)return[{black:n}];let e=t[t.length-1];return[...t.slice(0,-1),{...e,black:n}]}})}(B),function(e){if(e.captured&&e.captured.type){let l={white:{pawn:"♙",rook:"♖",knight:"♘",bishop:"♗",queen:"♕",king:"♔"},black:{pawn:"♟",rook:"♜",knight:"♞",bishop:"♝",queen:"♛",king:"♚"}}[e.captured.color][e.captured.type];"white"===e.piece.color?A(e=>[...e,l]):W(e=>[...e,l])}}(B),P("white"===F?"black":"white"),a&&a()}else if(null===(t=s[r])||void 0===t?void 0:t[c]){let e=s[r][c];if(!e)return;let l=y[e];if(l.color!==F)return;d({row:r,col:c}),m({from:{row:r,col:c},to:{row:r,col:c}}),b(null);let t=f(s),n=J(t);v(x[l.type]({x:c,y:r},t,l.color,n))}else u&&(j({row:u.row,col:u.col}),N.current&&clearTimeout(N.current),N.current=setTimeout(()=>{j(null)},1200)),d(null),b({row:r,col:c}),v([])}:()=>{};return(0,n.jsxs)("div",{className:"chess-layout",children:[(0,n.jsx)("div",{className:"chessboard-panel",children:(0,n.jsx)("div",{className:"chess-container",children:(0,n.jsx)("div",{className:"chess-board".concat(t?"":" disabled"),children:(l?[...s].reverse():s).map((e,t)=>(l?[...e].reverse():e).map((e,l)=>{let{actualRow:r,actualCol:c}=z(t,l),a=p&&p.from.row===r&&p.from.col===c,o=p&&p.to.row===r&&p.to.col===c,s=w&&w.row===r&&w.col===c,i=u&&D(r,c),d=g&&g.row===r&&g.col===c;return(0,n.jsxs)("div",{className:"chess-square ".concat((t+l)%2==0?"light":"dark"," ").concat(a||o?"green-highlight":""," ").concat(s?"yellow-highlight":""," ").concat(i?"highlight":""," ").concat(d?"red-blink":""),onClick:()=>Q(t,l),children:[e&&(0,n.jsx)("span",{className:"chess-piece",children:e}),0===l&&(0,n.jsx)("span",{className:"row-label",children:U[t]}),7===t&&(0,n.jsx)("span",{className:"column-label",children:Z[l]})]},"".concat(t,"-").concat(l))}))})})}),(0,n.jsxs)("div",{className:"info-panel",children:[(0,n.jsx)("div",{className:"info-left",children:l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"clock player-clock",children:["You: ",K(_)]}),(0,n.jsx)("div",{className:"captured-pieces captured-by-player",children:0===Y.length?(0,n.jsx)("span",{className:"captured-placeholder",children:"No captures"}):Y.map((e,l)=>(0,n.jsx)("span",{className:"captured-piece",children:e},l))}),(0,n.jsx)("div",{className:"info-separator"}),(0,n.jsx)("div",{className:"captured-pieces captured-by-opponent",children:0===L.length?(0,n.jsx)("span",{className:"captured-placeholder",children:"No captures"}):L.map((e,l)=>(0,n.jsx)("span",{className:"captured-piece",children:e},l))}),(0,n.jsxs)("div",{className:"clock opponent-clock",children:["Opponent: ",K(B)]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"clock opponent-clock",children:["Opponent: ",K(B)]}),(0,n.jsx)("div",{className:"captured-pieces captured-by-opponent",children:0===L.length?(0,n.jsx)("span",{className:"captured-placeholder",children:"No captures"}):L.map((e,l)=>(0,n.jsx)("span",{className:"captured-piece",children:e},l))}),(0,n.jsx)("div",{className:"info-separator"}),(0,n.jsx)("div",{className:"captured-pieces captured-by-player",children:0===Y.length?(0,n.jsx)("span",{className:"captured-placeholder",children:"No captures"}):Y.map((e,l)=>(0,n.jsx)("span",{className:"captured-piece",children:e},l))}),(0,n.jsxs)("div",{className:"clock player-clock",children:["You: ",K(_)]})]})}),(0,n.jsxs)("div",{className:"info-right",children:[(0,n.jsx)("div",{className:"move-list-title",children:"Move List"}),(0,n.jsx)("div",{className:"move-list",children:I.map((e,l)=>(0,n.jsx)("div",{className:"move-list-row",children:"".concat(l+1,". ").concat(e.white||"").concat(e.black?" "+e.black:"")},l))})]})]})]})};function w(e){let{gameMode:l,onBack:t}=e,[c,a]=(0,r.useState)(!1),[o,s]=(0,r.useState)(!1),[i,u]=(0,r.useState)(!0),[d,p]=(0,r.useState)(null);return(0,n.jsxs)("div",{className:"game-page",children:[(0,n.jsxs)("div",{className:"game-header-fixed",children:[(0,n.jsx)("button",{className:"back-btn",onClick:t,children:"← Back"}),(0,n.jsx)("span",{className:"game-title",children:"Chess Game"}),(0,n.jsx)("div",{})]}),(0,n.jsxs)("div",{className:"button-row",children:[(0,n.jsx)("button",{className:"main-action-btn",onClick:()=>{a(e=>(e&&p(null),!e))},disabled:!!d,children:c?"Stop Game":"Start Game"}),(0,n.jsx)("button",{className:"main-action-btn",onClick:()=>s(e=>!e),children:"Flip Board"}),(0,n.jsxs)("label",{className:"flip-toggle",children:[(0,n.jsx)("input",{type:"checkbox",checked:i,onChange:()=>u(e=>!e)}),(0,n.jsx)("span",{className:"flip-toggle-slider"}),(0,n.jsx)("span",{className:"flip-toggle-label",children:i?"Auto Flip":"Manual Flip"})]})]}),(0,n.jsxs)("div",{className:"game-board-area",style:{position:"relative"},children:[(0,n.jsx)(m,{isFlipped:o,boardEnabled:c&&!d,gameStarted:c,onMove:()=>{"pass"===l&&i&&s(e=>!e)},gameMode:l,onTimerZero:e=>{a(!1),p("white"===e?"black":"white")}}),d&&(0,n.jsxs)("div",{className:"winner-label",children:["white"===d?"White":"Black"," wins on time!"]})]})]})}function b(){let[e,l]=(0,r.useState)("start"),[t,a]=(0,r.useState)("friend");return(0,n.jsxs)("div",{className:"app-root",children:["start"===e&&(0,n.jsx)(c,{onSelectMode:e=>{a(e),l("game")}}),"game"===e&&(0,n.jsx)(w,{gameMode:t,onBack:()=>l("start")})]})}t(5399)},8227:(e,l,t)=>{Promise.resolve().then(t.bind(t,8059))},9289:()=>{}},e=>{var l=l=>e(e.s=l);e.O(0,[505,441,684,358],()=>l(8227)),_N_E=e.O()}]);