(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3520:()=>{},5399:()=>{},7827:(e,l,t)=>{"use strict";t.r(l),t.d(l,{default:()=>k});var r=t(5155),n=t(2115);function o(e){let{onSelectMode:l}=e;return(0,r.jsxs)("div",{className:"start-page",children:[(0,r.jsx)("h1",{className:"start-title",children:"Welcome to Modern Chess"}),(0,r.jsxs)("div",{className:"start-buttons",children:[(0,r.jsx)("button",{className:"start-btn friend",onClick:()=>l("friend"),children:"Play a Friend Online"}),(0,r.jsx)("button",{className:"start-btn pass",onClick:()=>l("pass"),children:"Pass and Play"})]})]})}t(9289);var c=t(8999);function a(e){return e.x>=0&&e.x<8&&e.y>=0&&e.y<8}function s(e,l,t){if(!a(l))return!1;let r=e[l.y][l.x];return!r||r.color!==t}function i(e,l,t){let r=[];for(let{dx:n,dy:o}of[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1}]){let c=e.x+n,s=e.y+o;for(;a({x:c,y:s});){let e=l[s][c];if(e){e.color!==t&&r.push({x:c,y:s});break}r.push({x:c,y:s}),c+=n,s+=o}}return r}function u(e,l,t){let r=[];for(let{dx:n,dy:o}of[{dx:1,dy:2},{dx:2,dy:1},{dx:-1,dy:2},{dx:-2,dy:1},{dx:1,dy:-2},{dx:2,dy:-1},{dx:-1,dy:-2},{dx:-2,dy:-1}]){let c={x:e.x+n,y:e.y+o};s(l,c,t)&&r.push(c)}return r}function d(e,l,t){let r=[];for(let{dx:n,dy:o}of[{dx:1,dy:1},{dx:1,dy:-1},{dx:-1,dy:1},{dx:-1,dy:-1}]){let c=e.x+n,s=e.y+o;for(;a({x:c,y:s});){let e=l[s][c];if(e){e.color!==t&&r.push({x:c,y:s});break}r.push({x:c,y:s}),c+=n,s+=o}}return r}function p(e,l,t){return[...i(e,l,t),...d(e,l,t)]}function h(e,l,t){let r=[];for(let{dx:n,dy:o}of[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1},{dx:1,dy:1},{dx:1,dy:-1},{dx:-1,dy:1},{dx:-1,dy:-1}]){let c={x:e.x+n,y:e.y+o};s(l,c,t)&&r.push(c)}return r}function x(e,l,t){for(let r=0;r<8;r++)for(let n=0;n<8;n++){let o=l[r][n];if(o&&o.color===t){let c=[];switch(o.type){case"pawn":let a="white"===t?-1:1;for(let l of[-1,1])if(n+l===e.x&&r+a===e.y)return!0;break;case"rook":c=i({x:n,y:r},l,t);break;case"knight":c=u({x:n,y:r},l,t);break;case"bishop":c=d({x:n,y:r},l,t);break;case"queen":c=p({x:n,y:r},l,t);break;case"king":c=h({x:n,y:r},l,t)}if(c.some(l=>l.x===e.x&&l.y===e.y))return!0}}return!1}t(3520);let y={pawn:(e,l,t,r)=>r?function(e,l,t,r){let n=[],o="white"===t?-1:1,c="white"===t?6:1,s={x:e.x,y:e.y+o};if(a(s)&&!l[s.y][s.x]){n.push(s);let t={x:e.x,y:e.y+2*o};e.y!==c||l[t.y][t.x]||l[s.y][s.x]||n.push(t)}for(let c of[-1,1]){var i;let s={x:e.x+c,y:e.y+o};a(s)&&l[s.y][s.x]&&(null===(i=l[s.y][s.x])||void 0===i?void 0:i.color)!==t&&n.push(s),function(e,l,t,r){if(!t.enPassantTarget||t.enPassantTarget.x!==l.x||t.enPassantTarget.y!==l.y||e.y!==("white"===r?3:4)||1!==Math.abs(e.x-l.x)||l.y!==e.y+("white"===r?-1:1))return!1;let n=t.moveHistory[t.moveHistory.length-1];return!!n&&"pawn"===n.piece.type&&2===Math.abs(n.from.y-n.to.y)&&n.to.x===l.x&&n.to.y===e.y}(e,s,r,t)&&n.push(s)}return n}(e,l,t,r):function(e,l,t){let r=[],n="white"===t?-1:1,o={x:e.x,y:e.y+n};if(a(o)&&!l[o.y][o.x]){r.push(o);let c={x:e.x,y:e.y+2*n};e.y!==("white"===t?6:1)||l[c.y][c.x]||r.push(c)}for(let o of[-1,1]){var c;let s={x:e.x+o,y:e.y+n};a(s)&&l[s.y][s.x]&&(null===(c=l[s.y][s.x])||void 0===c?void 0:c.color)!==t&&r.push(s)}return r}(e,l,t),rook:i,knight:u,bishop:d,queen:p,king:(e,l,t,r)=>r?function(e,l,t,r){let n=[];for(let{dx:r,dy:o}of[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1},{dx:1,dy:1},{dx:1,dy:-1},{dx:-1,dy:1},{dx:-1,dy:-1}]){let c={x:e.x+r,y:e.y+o};s(l,c,t)&&n.push(c)}return("white"===t&&4===e.x&&7===e.y||"black"===t&&4===e.x&&0===e.y)&&(function(e,l){let t=7*("white"===e),r="".concat(4,",").concat(t),n="".concat(7,",").concat(t);if(l.hasMoved[r]||l.hasMoved[n])return!1;for(let e=5;e<7;e++)if(l.board[t][e])return!1;for(let r=4;r<=6;r++)if(x({x:r,y:t},l.board,"white"===e?"black":"white"))return!1;return!0}(t,r)&&n.push({x:6,y:e.y}),function(e,l){let t=7*("white"===e),r="".concat(4,",").concat(t),n="".concat(0,",").concat(t);if(l.hasMoved[r]||l.hasMoved[n])return!1;for(let e=1;e<4;e++)if(l.board[t][e])return!1;for(let r=2;r<=4;r++)if(x({x:r,y:t},l.board,"white"===e?"black":"white"))return!1;return!0}(t,r)&&n.push({x:2,y:e.y})),n}(e,l,t,r):h(e,l,t)},f={"♙":{type:"pawn",color:"white"},"♖":{type:"rook",color:"white"},"♘":{type:"knight",color:"white"},"♗":{type:"bishop",color:"white"},"♕":{type:"queen",color:"white"},"♔":{type:"king",color:"white"},"♟":{type:"pawn",color:"black"},"♜":{type:"rook",color:"black"},"♞":{type:"knight",color:"black"},"♝":{type:"bishop",color:"black"},"♛":{type:"queen",color:"black"},"♚":{type:"king",color:"black"}};function w(e){return e.map(e=>e.map(e=>e?{...f[e]}:null))}let m=e=>{let{isFlipped:l,gameStarted:t,onMove:o}=e,[c,a]=(0,n.useState)([["♜","♞","♝","♛","♚","♝","♞","♜"],["♟","♟","♟","♟","♟","♟","♟","♟"],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],["♙","♙","♙","♙","♙","♙","♙","♙"],["♖","♘","♗","♕","♔","♗","♘","♖"]]),[s,i]=(0,n.useState)(null),[u,d]=(0,n.useState)(null),[p,h]=(0,n.useState)(null),[m,b]=(0,n.useState)([]),[k,v]=(0,n.useState)(null),g=(0,n.useRef)(null),[N,j]=(0,n.useState)({}),[S,M]=(0,n.useState)(null),[C,O]=(0,n.useState)([]),[q,P]=(0,n.useState)("white"),[T,_]=(0,n.useState)(600),[F,E]=(0,n.useState)(600),R=(0,n.useRef)(null),[B,I]=(0,n.useState)([]),[G,H]=(0,n.useState)([]),[Y,L]=(0,n.useState)([]),U=l?[1,2,3,4,5,6,7,8]:[8,7,6,5,4,3,2,1],W=l?["h","g","f","e","d","c","b","a"]:["a","b","c","d","e","f","g","h"],z=(e,t)=>({actualRow:l?7-e:e,actualCol:l?7-t:t}),A=(e,l)=>m.some(t=>t.x===l&&t.y===e);function D(e){return{board:e,moveHistory:C,hasMoved:N,enPassantTarget:S}}function J(e){let l=Math.floor(e/60);return"".concat(l,":").concat((e%60).toString().padStart(2,"0"))}(0,n.useEffect)(()=>(R.current&&clearInterval(R.current),R.current=setInterval(()=>{"white"===q?_(e=>e>0?e-1:0):E(e=>e>0?e-1:0)},1e3),()=>{R.current&&clearInterval(R.current)}),[q,t]);let K=(e,l)=>{var t,r;let{actualRow:n,actualCol:u}=z(e,l);if(!s){let e=null===(r=c[n])||void 0===r?void 0:r[u];if(!e){h({row:n,col:u}),b([]);return}let l=f[e];if(l.color!==q)return;i({row:n,col:u}),d({from:{row:n,col:u},to:{row:n,col:u}}),h(null);let t=w(c),o=D(t);b(y[l.type]({x:u,y:n},t,l.color,o));return}let{row:p,col:m}=s,k=c[p][m];if(!k){i(null),b([]);return}let T=f[k];if(T.color!==q){i(null),b([]);return}if(A(n,u)){if(function(e,l,t,r,n){let o=r.map(e=>[...e]),c=o[e.row][e.col];"king"===t.type&&2===Math.abs(l.col-e.col)?6===l.col?(o[e.row][4]=null,o[e.row][6]=c,o[e.row][7]=null,o[e.row][5]="white"===t.color?"♖":"♜"):2===l.col&&(o[e.row][4]=null,o[e.row][2]=c,o[e.row][0]=null,o[e.row][3]="white"===t.color?"♖":"♜"):"pawn"===t.type&&n&&l.col===n.x&&l.row===n.y?(o[l.row][l.col]=c,o[e.row][e.col]=null,o[e.row][l.col]=null):(o[l.row][l.col]=c,o[e.row][e.col]=null);let a="white"===t.color?"♔":"♚",s=null;for(let e=0;e<8;e++)for(let l=0;l<8;l++)o[e][l]===a&&(s={x:l,y:e});return"king"===t.type&&(s={x:l.col,y:l.row}),!s||x(s,w(o),"white"===t.color?"black":"white")}({row:p,col:m},{row:n,col:u},T,c,S)){v({row:p,col:m}),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{v(null)},1200);return}let e=c[p][m],l=e?f[e]:null,t=!1,r=null,s=null;l&&"king"===l.type&&2===Math.abs(u-m)&&(t=!0,6===u?(r={x:7,y:p},s={x:5,y:p}):2===u&&(r={x:0,y:p},s={x:3,y:p}));let y=!1,k=null;l&&"pawn"===l.type&&S&&u===S.x&&n===S.y&&(y=!0,k={row:p,col:u});let _=c.map(e=>[...e]);t&&r&&s?(_[n][u]=c[p][m],_[p][m]=null,_[s.y][s.x]=c[r.y][r.x],_[r.y][r.x]=null):y&&k?(_[n][u]=c[p][m],_[p][m]=null,_[k.row][k.col]=null):(_[n][u]=c[p][m],_[p][m]=null);let F={...N};l&&(F["".concat(m,",").concat(p)]=!0,t&&r&&(F["".concat(r.x,",").concat(r.y)]=!0));let E=null;l&&"pawn"===l.type&&2===Math.abs(n-p)&&(E={x:m,y:(p+n)/2});let R={from:{x:m,y:p},to:{x:u,y:n},piece:l,isCastling:t,isEnPassant:y,captured:y&&k?c[k.row][k.col]?f[c[k.row][k.col]]:null:c[n][u]?f[c[n][u]]:null};a(_),j(F),M(E),O([...C,R]),d({from:{row:p,col:m},to:{row:n,col:u}}),i(null),h(null),b([]),function(e){let l="white"===e.piece.color;I(t=>{let r=function(e,l,t){if(e.isCastling){if(6===e.to.x)return"O-O";if(2===e.to.x)return"O-O-O"}let r="abcdefgh",n="pawn"===e.piece.type?"":e.piece.type[0].toUpperCase(),o=e.captured?"x":"",c=r[e.to.x]+(8-e.to.y);return"pawn"===e.piece.type&&e.captured?r[e.from.x]+"x"+c:n+o+c}(e,Math.floor(t.length/2),0);if(l)return[...t,{white:r}];{if(0===t.length)return[{black:r}];let e=t[t.length-1];return[...t.slice(0,-1),{...e,black:r}]}})}(R),function(e){if(e.captured&&e.captured.type){let l={white:{pawn:"♙",rook:"♖",knight:"♘",bishop:"♗",queen:"♕",king:"♔"},black:{pawn:"♟",rook:"♜",knight:"♞",bishop:"♝",queen:"♛",king:"♚"}}[e.captured.color][e.captured.type];"white"===e.piece.color?L(e=>[...e,l]):H(e=>[...e,l])}}(R),P("white"===q?"black":"white"),o&&o()}else if(null===(t=c[n])||void 0===t?void 0:t[u]){let e=c[n][u];if(!e)return;let l=f[e];if(l.color!==q)return;i({row:n,col:u}),d({from:{row:n,col:u},to:{row:n,col:u}}),h(null);let t=w(c),r=D(t);b(y[l.type]({x:u,y:n},t,l.color,r))}else s&&(v({row:s.row,col:s.col}),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{v(null)},1200)),i(null),h({row:n,col:u}),b([])};return(0,r.jsxs)("div",{className:"chess-layout",children:[(0,r.jsx)("div",{className:"chessboard-panel",children:(0,r.jsxs)("div",{className:"chess-container",children:[(0,r.jsx)("div",{className:"chess-board",children:(l?[...c].reverse():c).map((e,t)=>(l?[...e].reverse():e).map((e,l)=>{let{actualRow:n,actualCol:o}=z(t,l),c=u&&u.from.row===n&&u.from.col===o,a=u&&u.to.row===n&&u.to.col===o,i=p&&p.row===n&&p.col===o,d=s&&A(n,o),h=k&&k.row===n&&k.col===o;return(0,r.jsxs)("div",{className:"chess-square ".concat((t+l)%2==0?"light":"dark"," ").concat(c||a?"green-highlight":""," ").concat(i?"yellow-highlight":""," ").concat(d?"highlight":""," ").concat(h?"red-blink":""),onClick:()=>K(t,l),children:[e&&(0,r.jsx)("span",{className:"chess-piece",children:e}),0===l&&(0,r.jsx)("span",{className:"row-label",children:U[t]}),7===t&&(0,r.jsx)("span",{className:"column-label",children:W[l]})]},"".concat(t,"-").concat(l))}))}),(0,r.jsx)("button",{className:"flip-button",onClick:()=>{h(null),s&&i({row:7-s.row,col:7-s.col})},children:"Flip Board"})]})}),(0,r.jsxs)("div",{className:"info-panel",children:[(0,r.jsx)("div",{className:"info-left",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"clock player-clock",children:["You: ",J(T)]}),(0,r.jsx)("div",{className:"captured-pieces captured-by-player",children:0===Y.length?(0,r.jsx)("span",{className:"captured-placeholder",children:"No captures"}):Y.map((e,l)=>(0,r.jsx)("span",{className:"captured-piece",children:e},l))}),(0,r.jsx)("div",{className:"info-separator"}),(0,r.jsx)("div",{className:"captured-pieces captured-by-opponent",children:0===G.length?(0,r.jsx)("span",{className:"captured-placeholder",children:"No captures"}):G.map((e,l)=>(0,r.jsx)("span",{className:"captured-piece",children:e},l))}),(0,r.jsxs)("div",{className:"clock opponent-clock",children:["Opponent: ",J(F)]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"clock opponent-clock",children:["Opponent: ",J(F)]}),(0,r.jsx)("div",{className:"captured-pieces captured-by-opponent",children:0===G.length?(0,r.jsx)("span",{className:"captured-placeholder",children:"No captures"}):G.map((e,l)=>(0,r.jsx)("span",{className:"captured-piece",children:e},l))}),(0,r.jsx)("div",{className:"info-separator"}),(0,r.jsx)("div",{className:"captured-pieces captured-by-player",children:0===Y.length?(0,r.jsx)("span",{className:"captured-placeholder",children:"No captures"}):Y.map((e,l)=>(0,r.jsx)("span",{className:"captured-piece",children:e},l))}),(0,r.jsxs)("div",{className:"clock player-clock",children:["You: ",J(T)]})]})}),(0,r.jsxs)("div",{className:"info-right",children:[(0,r.jsx)("div",{className:"move-list-title",children:"Move List"}),(0,r.jsx)("div",{className:"move-list",children:B.map((e,l)=>(0,r.jsx)("div",{className:"move-list-row",children:"".concat(l+1,". ").concat(e.white||"").concat(e.black?" "+e.black:"")},l))})]})]})]})};function b(e){let{gameMode:l,onBack:t}=e,[o,a]=(0,n.useState)(!1),[s,i]=(0,n.useState)(!1),u=(0,c.useRouter)();return(0,r.jsxs)("div",{className:"game-page",children:[(0,r.jsxs)("div",{className:"game-header-fixed",children:[(0,r.jsx)("button",{className:"back-btn",onClick:()=>{t?t():u.push("/")},children:"← Back"}),(0,r.jsx)("span",{className:"game-title",children:"Chess Game"}),(0,r.jsx)("div",{})]}),!o&&(0,r.jsx)("div",{className:"start-game-btn-row",children:(0,r.jsx)("button",{className:"start-game-btn",onClick:()=>a(!0),children:"Start Game"})}),(0,r.jsx)("div",{className:"game-board-area",children:(0,r.jsx)(m,{isFlipped:s,gameStarted:o,onMove:()=>{"pass"===l&&i(e=>!e)},gameMode:l})})]})}function k(){let[e,l]=(0,n.useState)("start"),[t,c]=(0,n.useState)("friend");return(0,r.jsxs)("div",{className:"app-root",children:["start"===e&&(0,r.jsx)(o,{onSelectMode:e=>{c(e),l("game")}}),"game"===e&&(0,r.jsx)(b,{gameMode:t,onBack:()=>l("start")})]})}t(5399)},8227:(e,l,t)=>{Promise.resolve().then(t.bind(t,7827))},9289:()=>{}},e=>{var l=l=>e(e.s=l);e.O(0,[505,441,684,358],()=>l(8227)),_N_E=e.O()}]);